var E=Object.defineProperty,F=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var y=(o,t,r)=>t in o?E(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,C=(o,t)=>{for(var r in t||(t={}))T.call(t,r)&&y(o,r,t[r]);if(k)for(var r of k(t))A.call(t,r)&&y(o,r,t[r]);return o},w=(o,t)=>F(o,N(t));import{a as x,B as R,E as z,T as B}from"./index.esm.76000dbd.js";import{_ as V,a as I,c as g}from"./index.83e2ae4f.js";import{am as M,aq as O,u as S,r as $,au as j,E as m,o as H,b as _,av as q,t as K,d as i,e as U,n as D,w as c,j as d,g as G,k as J,i as L}from"./vendor.c58b0721.js";function P(o,t){const{link:r="",fileName:n=""}=o;return`<a data-w-e-type="attachment" data-w-e-is-void data-w-e-is-inline data-link="${r}" data-fileName="${n}" href="${r}" target="_blank">${n}</a>`}const Q={type:"attachment",elemToHtml:P};x.elemsToHtml=[Q];R.registerModule(x);const W={name:"brief_add",components:{Editor:z,Toolbar:B},setup(){const o=M(null),t=O(),r=S(),{id:n}=t.query,l=$({token:"Bearer "+I("token")||"",id:n,briefForm:{content:""},rules:{content:[{required:!1,message:"\u5185\u5BB9\u5FC5\u987B",trigger:["change"]}]}}),f=j(),p={insertKeys:{index:31,keys:["uploadAttachment"]}},b={placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9...",hoverbarKeys:{attachment:{menuKeys:["downloadAttachment"]}},MENU_CONF:{uploadImage:{server:g,fieldName:"file",maxFileSize:2*1024*1024,maxNumberOfFiles:10,allowedFileTypes:["image/*"],meta:{basket:"img"},headers:{Authorization:l.token},customInsert:function(e,a){a(e.data.src,e.data.file_name,e.data.src)},onError(e,a,s){m.error(new Error(a).message),console.log(e,a,s)}},uploadVideo:{server:g,fieldName:"file",maxFileSize:100*1024*1024,allowedFileTypes:["video/*"],meta:{basket:"video"},headers:{Authorization:l.token},customInsert:function(e,a){a(e.data.src)},onError(e,a,s){m.error(new Error(a).message),console.log(e,a,s)}},uploadAttachment:{server:g,fieldName:"file",maxFileSize:10*1024*1024,meta:{basket:"attachment"},headers:{Authorization:l.token},customInsert:function(e,a,s){s(`${a.name}`,e.data.src)},onError(e,a,s){m.error(new Error(a).message),console.log(e,a,s)}}}},u=e=>{f.value=e};H(()=>{n&&_.get(`/api/back/briefs/${n}`).then(e=>{l.briefForm={content:e.data.content}})}),q(()=>{const e=f.value;e!=null&&e.destroy()});const h=()=>{o.value.validate(e=>{if(e){let a=_.post,s={content:l.briefForm.content},v="/api/back/briefs";n&&(a=_.put,v=`/api/back/briefs/${n}`),a(v,s).then(()=>{n?m.success("\u4FEE\u6539\u6210\u529F"):m.success("\u6DFB\u52A0\u6210\u529F"),r.push({path:"/brief"})})}})};return w(C({},K(l)),{editorRef:f,mode:"default",toolbarConfig:p,editorConfig:b,handleCreated:u,briefRef:o,submitAdd:h})}},X={style:{border:"1px solid #ccc","z-index":"100"}};function Y(o,t,r,n,l,f){const p=i("Toolbar"),b=i("Editor"),u=i("el-form-item"),h=i("el-button"),e=i("el-form"),a=i("el-card");return U(),D(a,{style:{"min-height":"100%"}},{default:c(()=>[d(e,{model:o.briefForm,rules:o.rules,ref:"briefRef","label-width":"100px",style:{"margin-top":"30px"}},{default:c(()=>[d(u,{label:"\u5185\u5BB9",prop:"content"},{default:c(()=>[G("div",X,[d(p,{style:{"border-bottom":"1px solid #ccc"},editor:n.editorRef,defaultConfig:n.toolbarConfig,mode:n.mode},null,8,["editor","defaultConfig","mode"]),d(b,{style:{height:"500px","overflow-y":"hidden"},modelValue:o.briefForm.content,"onUpdate:modelValue":t[0]||(t[0]=s=>o.briefForm.content=s),defaultConfig:n.editorConfig,mode:n.mode,onOnCreated:n.handleCreated},null,8,["modelValue","defaultConfig","mode","onOnCreated"])])]),_:1}),d(u,null,{default:c(()=>[d(h,{type:"primary",onClick:t[1]||(t[1]=s=>n.submitAdd())},{default:c(()=>[J(L(o.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}var ae=V(W,[["render",Y]]);export{ae as default};
